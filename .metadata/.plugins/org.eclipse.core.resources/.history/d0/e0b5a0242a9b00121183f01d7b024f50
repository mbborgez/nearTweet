package pt.utl.ist.cm.neartweetclient.connectionTasks;

import pt.utl.ist.cm.neartweetEntities.pdu.PDU;
import pt.utl.ist.cm.neartweetclient.exceptions.ErrorSendingMessageException;
import pt.utl.ist.cm.neartweetclient.exceptions.NearTweetException;
import pt.utl.ist.cm.neartweetclient.exceptions.NotConnectedException;
import pt.utl.ist.cm.neartweetclient.services.ConnectToServerService;
import android.os.AsyncTask;
import android.util.Log;

public abstract class BaseAsyncTask <Params, Progress, Result> extends AsyncTask<Params, Progress, Result>{

	public boolean connect(String serverAddress, int serverPort){
		try{
			ConnectToServerService connectService = new ConnectToServerService(serverAddress, serverPort);
			connectService.execute();
			return true;
		}catch(NearTweetException e){
			return false;
		}
	}
	
	public boolean sendPDU(PDU pdu){
		if(!ConnectionStatus.getInstance().isConnected()){
			return false;
		}

		try {
			Log.i(this.getClass().toString(), "Sending pdu " + pdu);
			ConnectionStatus.getInstance().sendPDU(pdu);
			Log.i(this.getClass().toString(), "Pdu sent! " + pdu);
			return true;
		} catch (ErrorSendingMessageException e) {
			return false;
		}

	}
		

}
